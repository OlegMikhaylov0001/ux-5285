(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function p(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerPolicy&&(r.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?r.credentials="include":t.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(t){if(t.ep)return;t.ep=!0;const r=p(t);fetch(t.href,r)}})();document.addEventListener("DOMContentLoaded",()=>{new URLSearchParams(window.location.search).get("clear")==="true"&&(localStorage.removeItem("authToken"),window.history.replaceState({},document.title,window.location.pathname));const c=localStorage.getItem("authToken");if(c&&!window.location.hostname.includes("localhost")&&!window.location.hostname.includes("127.0.0.1")){window.location.href=`https://www.dating.com/people/#token=${c}`;return}c&&(window.location.hostname.includes("localhost")||window.location.hostname.includes("127.0.0.1"))&&console.log("Saved token found (localhost mode):",c);const p=document.querySelector(".buttonForm"),s=document.querySelector(".popup-overlay"),t=document.querySelector(".popup-close"),r=document.querySelector(".popup-form");p&&s&&p.addEventListener("click",()=>{s.style.display="flex"}),t&&s&&(t.addEventListener("click",()=>{l()}),s.addEventListener("click",o=>{o.target===s&&l()})),document.addEventListener("keydown",o=>{o.key==="Escape"&&s.style.display==="flex"&&l()}),r&&r.addEventListener("submit",g);function l(){s.style.display="none"}async function g(o){o.preventDefault();const n=r.querySelector("#email"),i=r.querySelector("#password"),u=n.value.trim(),d=i.value.trim();if(y(u,d)){try{const e=await fetch("https://api.dating.com/identity",{method:"GET",headers:{Authorization:`Basic ${btoa(`${u}:${d}`)}`}});if(e.ok){const a=e.headers.get("X-Token");if(console.log("Authorization successful, token:",a),a){localStorage.setItem("authToken",a),window.location.href=`https://www.dating.com/people/#token=${a}`;return}}}catch(e){console.log("Authorization failed, trying registration:",e)}try{const e=await fetch("https://api.dating.com/identity",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:u,password:d})});if(e.ok){const a=e.headers.get("X-Token");console.log("Registration successful, token:",a),a&&localStorage.setItem("authToken",a),k()}else{const a=await e.text();console.error("Registration failed:",e.status,a),e.status===400?m("User already exists or invalid data. Please check your credentials."):m(`Registration failed: ${e.status} - ${e.statusText}`)}}catch(e){console.error("Network error:",e),m("Network error. Please check your connection and try again.")}}}function y(o,n){v();let i=!0;return w(o)||(f("email","Please enter a valid email address"),i=!1),n.length<8&&(f("password","Password must be at least 8 characters long"),i=!1),i}function w(o){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o)}function f(o,n){var u,d;const i=document.getElementById(o);if(i){let e=(u=i.parentElement)==null?void 0:u.querySelector(".error-message");e||(e=document.createElement("div"),e.className="error-message",(d=i.parentElement)==null||d.appendChild(e)),e.textContent=n}}function v(){document.querySelectorAll(".error-message").forEach(n=>n.remove())}function m(o){alert(o)}function k(){const o=document.querySelector(".popup-content");if(o){o.innerHTML=`
          <button class="popup-close">
            <img src="/assets/crossClosed.svg" alt="close button" />
          </button>
          <div class="success-message">
            <h2>Thank You!</h2>
            <p>To complete registration, please check your e-mail</p>
          </div>
        `;const n=o.querySelector(".popup-close");n&&n.addEventListener("click",l)}}});
