(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))a(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function p(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerPolicy&&(r.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?r.credentials="include":t.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(t){if(t.ep)return;t.ep=!0;const r=p(t);fetch(t.href,r)}})();document.addEventListener("DOMContentLoaded",()=>{new URLSearchParams(window.location.search).get("clear")==="true"&&(localStorage.removeItem("authToken"),window.history.replaceState({},document.title,window.location.pathname));const c=localStorage.getItem("authToken");if(c&&!window.location.hostname.includes("localhost")&&!window.location.hostname.includes("127.0.0.1")){window.location.href=`https://www.dating.com/people/#token=${c}`;return}c&&(window.location.hostname.includes("localhost")||window.location.hostname.includes("127.0.0.1"))&&console.log("Saved token found (localhost mode):",c);const p=document.querySelector(".buttonForm"),a=document.querySelector(".popup-overlay"),t=document.querySelector(".popup-close"),r=document.querySelector(".popup-form");p&&a&&p.addEventListener("click",()=>{a.style.display="flex"}),t&&a&&(t.addEventListener("click",()=>{l()}),a.addEventListener("click",o=>{o.target===a&&l()})),document.addEventListener("keydown",o=>{o.key==="Escape"&&a.style.display==="flex"&&l()}),r&&r.addEventListener("submit",h);function l(){a.style.display="none"}async function h(o){o.preventDefault();const n=r.querySelector("#email"),s=r.querySelector("#password"),u=n.value.trim(),d=s.value.trim();if(g(u,d)){try{const e=await fetch("https://api.dating.com/identity",{method:"GET",headers:{Authorization:`Basic ${btoa(`${u}:${d}`)}`}});if(e.ok){const i=e.headers.get("X-Token");if(console.log("Authorization successful, token:",i),i){localStorage.setItem("authToken",i),window.location.href=`https://www.dating.com/people/#token=${i}`;return}}}catch(e){console.log("Authorization failed, trying registration:",e)}try{const e=await fetch("https://api.dating.com/identity",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:u,password:d})});if(e.ok){const i=e.headers.get("X-Token");console.log("Registration successful, token:",i),i&&localStorage.setItem("authToken",i),S()}else{const i=await e.text();console.error("Registration failed:",e.status,i),e.status===400?f("User already exists or invalid data. Please check your credentials."):f(`Registration failed: ${e.status} - ${e.statusText}`)}}catch(e){console.error("Network error:",e),f("Network error. Please check your connection and try again.")}}}function g(o,n){v();let s=!0;return w(o)||(m("email","Please enter a valid email address"),s=!1),n.length<8&&(m("password","Password must be at least 8 characters long"),s=!1),s}function w(o){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o)}function m(o,n){var u,d;const s=document.getElementById(o);if(s){let e=(u=s.parentElement)==null?void 0:u.querySelector(".error-message");e||(e=document.createElement("div"),e.className="error-message",(d=s.parentElement)==null||d.appendChild(e)),e.textContent=n}}function v(){document.querySelectorAll(".error-message").forEach(n=>n.remove())}function f(o){alert(o)}function S(){const o=document.querySelector(".popup-overlay:not(.success-popup)"),n=document.querySelector(".success-popup");if(o&&(o.style.display="none"),n){n.style.display="flex";const s=n.querySelector(".popup-close");s&&s.addEventListener("click",()=>{n.style.display="none"})}}});
